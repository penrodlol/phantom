---
import type { HTMLAttributes } from 'astro/types';
import { twMerge } from 'tailwind-merge';
import { tv, type VariantProps } from 'tailwind-variants';

type Props = HTMLAttributes<'button'> & VariantProps<typeof buttonVariants>;

// prettier-ignore
export const buttonVariants = tv({
  base:
    'inline-flex items-center justify-center gap-1 whitespace-nowrap rounded font-medium ' +
    'disabled:opacity-50 disabled:cursor-not-allowed ' +
    'focus-visible:ring-1 focus-visible:outline-none motion-safe:transition-colors',
  defaultVariants: { color: 'primary', size: 'md' },
  variants: {
    outline: { true: 'border [&:not(:hover)]:bg-transparent' },
    color: {
      primary: 'bg-surface-primary text-foreground-primary enabled:hover:bg-surface-primary/80',
      secondary: 'bg-surface-secondary text-foreground-secondary enabled:hover:bg-surface-secondary/80',
      accent: 'bg-surface-accent text-foreground-accent enabled:hover:bg-surface-accent/80',
      neutral: 'bg-surface-neutral text-foreground-neutral enabled:hover:bg-surface-neutral/80',
      ghost: 'hover:bg-surface-neutral/50 enabled:hover:text-foreground-neutral',
      danger: 'bg-surface-danger text-foreground-danger enabled:hover:bg-surface-danger/80',
    },
    size: {
      sm: 'h-8 px-3 text-sm',
      md: 'h-9 px-4 text-base',
      lg: 'h-11 px-8 text-lg',
      icon: 'size-8 *:size-4',
    },
  },
  compoundVariants: [
    { outline: true, color: 'primary', class: 'border-surface-primary text-foreground-primary-outline enabled:hover:bg-surface-primary/20' },
    { outline: true, color: 'secondary', class: 'border-surface-secondary text-foreground-secondary-outline enabled:hover:bg-surface-secondary/20' },
    { outline: true, color: 'accent', class: 'border-surface-accent text-foreground-accent-outline enabled:hover:bg-surface-accent/20' },
    { outline: true, color: 'neutral', class: 'border-surface-neutral text-foreground-neutral-outline enabled:hover:bg-surface-neutral/20' },
    { outline: true, color: 'danger', class: 'border-surface-danger text-foreground-danger-outline enabled:hover:bg-surface-danger/20' }, 
  ],
});

const { class: className, type, color, size, outline, ...props } = Astro.props;
---

<button
  {...props}
  type={type ?? 'button'}
  class={twMerge(buttonVariants({ color, size, outline }), className)}
>
  <slot />
</button>
